\section{Effective mass equation}
\thm{Effective mass equation}{
	\begin{align}
		\psi(\vec{r}, t) &= \sum_{\vec{k}}^{}c_{\vec{k}}(t)\psi_{n, \vec{k}}(\vec{r}) \nonumber \\
		&= \sum_{\vec{k}}^{}c_{\vec{k}}(t)u_{n, \vec{k}}(\vec{r})e^{i\vec{k}\cdot\vec{r}} \label{eqn:eff_mass_above}
	\end{align}
	We will restrict the coeficcients $c_{\vec{k}}(t)$ to values around $\vec(k)_0$, where $\vec(k)_0$ is located a a band extremum. We get a visualization like
	\begin{center}
		\begin{tikzpicture}
			\draw[->, black]	(0, 0) to (2, 0) node[right]{$k$};
			\draw[->, black]	(0, 0) to (0, 2) node[above]{$c_{\vec{k}}$};

			\draw[blue, very thick]	plot[samples=200, domain=-4:4] ({\x/4 + 1}, {1/(1 + \x*\x)});

			\draw[red, dashed, thick] 	(1, 1.5) to (1, 0) node[below]{$k_0$};
		\end{tikzpicture}
	\end{center}
	Because they are sharply peaked we can write equation \ref{eqn:eff_mass_above} as
	\begin{align}
		\psi(\vec{r}, t) &= \sum_{\vec{k}}^{}c_{\vec{k}}(t)u_{n, \vec{k}_0}(\vec{r})e^{i\vec{k}\cdot\vec{r}} \nonumber \\
		&= \sum_{\vec{k}}^{}c_{\vec{k}}(t)u_{n, \vec{k}_0}(\vec{r})e^{i\vec{k}\cdot\vec{r}}e^{i\vec{k}_0\cdot\vec{r}}e^{-i\vec{k}_0\cdot\vec{r}} \nonumber \\
		&= \sum_{\vec{k}}^{}c_{\vec{k}}(t)e^{i(\vec{k}-\vec{k}_0)\cdot\vec{r}}\psi_{n, \vec{k}_0}(\vec{r}) \nonumber \\
		&= \psi_{n, \vec{k}_0}(\vec{r})\sum_{\vec{k}}^{}c_{\vec{k}}(t)e^{i(\vec{k}-\vec{k}_0)\cdot\vec{r}} \label{eqn:new_psi}
	\end{align}
	The function $\sum_{\vec{k}}^{}c_{\vec{k}}(t)e^{i(\vec{k}-\vec{k}_0)\cdot\vec{r}}$ will oscillate if $\vec{k}$ is far away from $\vec{k}_0$, which cannot happen. Therefore this function varies slowly in time. This funtion is called the \textbf{envelope wave function}:
	\begin{equation}
		F(\vec{r}, t) = \sum_{\vec{k}}^{}c_{\vec{k}}(t)e^{i(\vec{k}-\vec{k}_0)\cdot\vec{r}}
	\end{equation}
	Yet again, we have constructed some kind of wave packet. In particular, it turns out that if we restrict the coefficients around the values $k_0$ (with some deviation $\Delta k$, $\Delta k << \frac{2\pi}{a}$). This implies that the uncertainty of the position $\Delta x >> a$. \\
	This is a result from the fourier analyis and wave-packets that give a relation $\Delta x \Delta k > 1$, it is the same relation that gives rise to the Heisenberg uncertainty principle. \\ \newline
	How does this description of the wavefunction behave when the operator $\hat{E}(-i\vec{\nabla})$ acts on it? We perform the same principle as in section \ref{sec:eff_mass_th}
	\begin{align}
		\hat{E}(-i\vec{\nabla})\psi(\vec{r}, t) &= \hat{E}(-i\vec{\nabla})\left[\psi_{n, \vec{k}_0}(\vec{r})F(\vec{r}, t)\right] \\
		&= \sum_m^{}E_me^{\vec{R}_m\cdot\vec{\nabla}}\left[\psi_{n, \vec{k}_0}(\vec{r})F(\vec{r}, t)\right] \\
		&= \sum_m^{}E_m\psi_{n, \vec{k}_0}(\vec{r} + \vec{R}_m)F(\vec{r} + \vec{R}_m, t) \\
		\text{using Bloch} \qquad &= \sum_m^{}E_me^{i\vec{R}_m\cdot\vec{k}_0}\psi_{n, \vec{k}_0}(\vec{r})e^{\vec{R}_m\cdot\vec{\nabla}}F(\vec{r}, t) \\
		&= \sum_m^{}E_m\psi_{n, \vec{k}_0}(\vec{r})e^{i\vec{R}_m\cdot(\vec{k}_0 - i\vec{\nabla})}F(\vec{r}, t) \\
		&= \psi_{n, \vec{k}_0}(\vec{r})\sum_m^{}E_me^{i\vec{R}_m\cdot(\vec{k}_0 - i\vec{\nabla})}F(\vec{r}, t)
	\end{align}
	And this is nothing else as
	\begin{equation}
		\psi_{n, \vec{k}_0}(\vec{r})\hat{E}(\vec{k}_0 - i\vec{\nabla})F(\vec{r}, t) \label{eqn:make_use}
	\end{equation} \\ \newline
	As a result, using the effective mass theorem we can become a more general description (i.e. the effective mass equation) by making use of equation \ref{eqn:new_psi} and equation \ref{eqn:make_use}:
	\begin{equation}
		i\hbar\frac{\delta F}{\delta t} = \left[\hat{E}(\vec{k}_0 - i\vec{\nabla}) + V_{ext}\right]F(\vec{r}, t) \label{eqn:eff_mass_eq}
	\end{equation}
}
How can we use the effective mass equation? Suppose we look at a CB minimum located at $\vec{k}_0$, not located at the $\Gamma$-point. We can than say that because we are at a minium, we can write
\begin{equation}
	E_n(\vec{k}) = E_n(\vec{k}_0) + \frac{1}{2}\sum_{i, j}^{} \left\frac{\delta^2E_n(\vec{k})}{\delta k_i \delta k_j}\right|_{\vec{k} = \vec{k}_0}(k_i -k_{i, 0})(k_j - k_{j, 0})
\end{equation}
Then the effecive mass eqution becomes:
\begin{align}
	i\hbar\frac{\delta F}{\delta t} &= \left[\hat{E}(\vec{k}_0 - i\vec{\nabla}) + V_{ext}\right]F(\vec{r}, t) \\
	&\text{where} \quad \hat{E}(\vec{k}_0 - i\vec{\nabla}) = E_n(\vec{k}_0) - \frac{1}{2}\sum_{i, j}^{} \left\frac{\delta^2E_n(\vec{k})}{\delta k_i \delta k_j}\right|_{\vec{k} = \vec{k}_0}\frac{\delta}{\delta r_i} \frac{\delta}{\delta r_j} \\
	\text{using equation \ref{eqn:eff_mass_tensor}}\quad \Rightarrow \quad i\hbar\frac{\delta F}{\delta t} &= \left[\hat{E}_n(\vec{k}_0) - \frac{\hbar^2}{2}\sum_{i, j}^{}\left[m^{*}_{i, j}\right]^{-1}\frac{\delta}{\delta r_i} \frac{\delta}{\delta r_j} + V_{ext}\right]F
\end{align}
\ex{Using the effective mass equation - 1D}{
	Consider a CB minimum at $k = 0$. Then, the conduction band is described by:
	\begin{equation*}
		E_{CB}(k) = E_{CB} + \frac{\hbar^2k^2}{2m^*} \qquad \text{with } m^* > 0
	\end{equation*}
	Then, we can find the envelope wave function as
	\begin{equation*}
		i\hbar\frac{\delta F}{\delta t} = \left[E_{CB} - \frac{\hbar^2}{2m^*}\frac{d^2}{dx^2} + V_{ext}\right]F
	\end{equation*}
	Say we take $V_{ext} = 0$, then (after filling in $F(x, t) = \psi(x)e^{-iEt/\hbar}$) we get:
	\begin{equation*}
		-\frac{\hbar^2}{2m^*}\frac{d^2}{dx^2}\psi(x) = (E - E_{CB})\psi(x)
	\end{equation*}
	This is just a normal time independent Schrödinger equation.
}
Remember that earlier was said that when working with acceptors and donors, the energy levels of these acceptors and donors, first of all, were in the energy gap, but also that they had a hydrogen-like energy spectrum. From that spectrum, it is possible to derive the ionization energy for the energy levels of the acceptors and donors.
\ex{E-spectrum of donor impurities in GaAs (III - V)}{
	We will replace Ga by Si. Then wat is the $V_{ext}$ introduced by Si? Well what we want to know is the folowing
	\begin{align*}
		V_{ext}(\vec{r}) &= V_{Si}(\vec{r}) - V_{Ga}(\vec{r}) \\
		&= -\frac{(Z_{Ga} + 1)e^2}{4\pi\epsilon\abs{\vec{r}}} + \frac{Z_{Ga}e^2}{4\pi\epsilon\abs{\vec{r}}} \\
		&= -\frac{e^2}{4\pi\epsilon\abs{\vec{r}}}
	\end{align*}
	We know that the energy of the conduction band is given by:
	\begin{equation*}
		E(\vec{k}) = E_c + \frac{\hbar^2k^2}{2m^*}
	\end{equation*}
	Then the effective mass equation becomes:
	\begin{align*}
		i\hbar\frac{\delta F}{\delta t} &= \left[E_c - \frac{\hbar^2}{2m^*}\nabla^2 - \frac{e^2}{4\pi\epsilon\abs{\vec{r}}}\right]F(\vec{r}, t) \\
		&\text{with} \qquad F(\vec{r}, t) = \psi(\vec{r})e^{-i/\hbar Et} \\
		\left[- \frac{\hbar^2}{2m^*}\nabla^2 - \frac{e^2}{4\pi\epsilon\abs{\vec{r}}}\right]\psi(\vec{r}) = (E - E_c)\psi(\vec{r})
	\end{align*}
	This is just the Schrödinger equation for a hydrogen atom with one electron, instead now with an effective mass $m^*$. Particulary, we are looking for the \textbf{bound states}.
	For hydrogen we know then that $E - E_c$ must be given by
	\begin{equation*}
		E - E_c = -\frac{e^4m^*}{2n^2(4\pi\epsilon\hbar)^2} \qquad \text{with } n = 1, 2, \dots
	\end{equation*}
	Now we have degeneracies and an ionization energy. Once this energy level is passed, electrons can freely move in the conduction band. The result is given in this figure:
	\begin{center}
		\begin{tikzpicture}
			\draw[->, black]	(0, -0.12) to (0, 2) node[above]{$E$};

			\foreach \y in {1,...,10} {
				\draw[blue, thick]	plot[samples=200, domain=-1:1] (\x, {1.88-\y*\y*\y/500});
			}

			\draw[<->, red, thick]		(1.1, -0.12) to node[right]{Ionization energy} (1.1, 1.88);

			\draw[blue]		(-1, -0.12) node[left]{$E_D$ $(n = 1)$};
			\draw[blue]		(-1, 2) node[left]{$E_c$};
		\end{tikzpicture}
	\end{center}
}
\ex{E-spectrum of acceptor impurities in Si}{
	Now, we will replace Si by an acceptor. We can now define $V_{ext}$ as
	\begin{equation*}
		V_{ext} = \frac{e^2}{4\pi\epsilon\abs{\vec{r}}}
	\end{equation*}
	Then the energy solution of the valence band becomes (after introduction of $m_h = -m^* > 0$):
	\begin{equation*}
		E(\vec{k}) = -\frac{\hbar^2k^2}{2m_h}
	\end{equation*}
	Then we can write the effective mass equation as
	\begin{align*}
		i\hbar\frac{\delta F}{\delta t} = \left[\frac{\hbar^2}{2m_h}\nabla^2 + \frac{e^2}{4\pi\epsilon\abs{\vec{r}}}\right]F \\
		\Rightarrow \quad \left[\frac{\hbar^2}{2m_h}\nabla^2 + \frac{e^2}{4\pi\epsilon\abs{\vec{r}}}\right]\psi(\vec{r}) = E\psi(\vec{r})
	\end{align*}
	Now, this is just the hydrogen spectrum, at least if we introduce some minus signs. We get the following:
	\begin{equation*}
		\left[-\frac{\hbar^2}{2m_h}\nabla^2 - \frac{e^2}{4\pi\epsilon\abs{\vec{r}}}\right]\psi(\vec{r}) = -E\psi(\vec{r})
	\end{equation*}
	If we then take $\tilde{E} = -E$ the 'hydrogen' atom is complete. We get the following figure:
	\begin{center}
		\begin{tikzpicture}
			\draw[->, black]	(0, -0.12) to (0, 2) node[above]{$E$};

			\foreach \y in {1,...,10} {
				\draw[blue, thick]	plot[samples=200, domain=-1:1] (\x, {\y*\y*\y/500 - 0.12});
			}
			\draw[blue, thick]	plot[sample=200, domain=-1:1]	(\x, -\x*\x - 0.12) node[right]{$E_v$};

			\draw[<->, red, thick]		(1.1, -0.12) to node[right]{Ionization energy} (1.1, 1.88);

			\draw[blue]		(-1, 2) node[left]{$E_D$ $(n = 1)$};
		\end{tikzpicture}
	\end{center}
	Yet again, if we want to get an electron to the acceptor level we need an energy equal to the "Ionization energy"
}

\section{Semi-classical electron (or hole) dynamics}
When the external field is time varying, solving the effective mass theorem (equation \ref{eqn:eff_mass_theorem}) for electrons (or holes) in the VB or CB becomes rather difficult to solve. Now luckily, it turns out one can find a solution (by approximation) for the effective mass theorem. Meaning one can derive semi-classical equation of motion.
The effective mass theorem given by equation \ref{eqn:eff_mass_theorem} has a wave function
\begin{align}
	\psi(\vec{r}, t) &= \sum_{\vec{k}}^{}c_{\vec{k}}(t)\psi_{n, \vec{k}}(\vec{r}) \\
	&= \psi_{n, \vec{k}_0}F(\vec{r}, t) \label{eqn:simplification_peak}
\end{align}
Because $c_{\vec{k}}(t)$ is sharply peaked around $k_0$ in the conduction band and valence band, we can write it as equation \label{eqn:simplification_peak}.\\ \par
For classical/semi-classical particles/electrons, we know that $\vec{p}$ and $\vec{r}$ is well defined. So how can we define them?\\
In figure \ref{fig:particles_lattice_semi} we see an underlying lattice and the envelope wave function (because $c$ is sharply peaked we have this). We can decrease $\Delta x$, however this way we increase $\Delta p$. From fourier analysis, we know that
\begin{equation}
	\Delta x \Delta k > 1 \quad \Rightarrow \quad \Delta x \Delta p > \hbar
\end{equation}
So we will need our Bloch electrons to behave with a $\Delta x <<$ variation of $V_{ext}$ and that $\Delta x >> a$. Why this last statement? We want the uncertainty on $k$ ($\Delta k$) to be within the firt BZ.
\begin{figure}
	\centering
	\begin{tikzpicture}
		\draw[->, black]	(0, 0) to (4.2, 0) node[right]{$x$};
		\draw[<->, red]		(0.8, -0.2)	to node[below]{$a$} (1, -0.2);
		\draw[<->, red]		(1.4, 0.5) to node[below]{$\Delta x$} (2.6, 0.5);

		\draw[blue, thick]		plot[samples=200, domain=-2:2]	(\x + 2, {1/(1 + 2*\x*\x)});

		\foreach \x in {1, ..., 20} {
			\draw[-]	(\x/5, -0.1) to (\x/5, 0.1);
		}
	\end{tikzpicture}
	\caption{Underlying lattice with envelope wave function}
	\label{fig:particles_lattice_semi}
\end{figure}

\subsection{The semi-classical approach}
Instead of using $\hat{H} = \hat{E}(-i\vec{\nabla}) + V_{ext}(\vec{r}, t)$ we use $H =  E(\vec{k}) + V_{ext}(\vec{r}, t)$ which is equivalent to $H =  E(\frac{\vec{P}_C}{\hbar}) + V_{ext}(\vec{r}, t)$. With $\vec{P}_C$ the crystal momentum. \\
Now, the hamiltonian equations represent the well known Newton equations of motion:
\begin{align}
	\frac{\delta H}{\delta \vec{r}} &= \vec{\nabla}_{\vec{x}}H = -\frac{\delta\vec{P}_C}{\delta t} \label{eqn:ref1}\\
	\frac{\delta H}{\delta \vec{r}} &= \vec{\nabla}_{\vec{P}_C}H = \frac{\delta\vec{x}}{\delta t} \label{eqn:ref2}
\end{align}
Then we can derive the semi-classical equation as
\begin{align}
	\text{from equation \ref{eqn:ref1}} &\qquad \frac{\delta \vec{P}_C}{\delta t} = \frac{\delta}{\delta t}(\hbar\vec{k}) = -\vec{\nabla}_{\vec{x}}H = \vec{F}_{ext}(\vec{r}, t) \\*
	\text{from equation \ref{eqn:ref2}} &\qquad \frac{\delta \vec{x}}{\delta t} = \vec{v} = \vec{\nabla}_{\vec{P}_C}H = \vec{\nabla}_{\vec{P}_C}E_n(\frac{\vec{P}_C}{\hbar}) = \frac{1}{\hbar}\vec{\nabla}_{\vec{k}}E_n(\vec{k}) = \vec{v}_g(\vec{k})
\end{align}

\ex{Constant $F_{ext}$ - 1D example}{
	\begin{align}
		\hbar\frac{\delta k}{\delta t} &= F_{ext} \quad \Rightarrow \quad k(t) = k(0) + \frac{F_{ext}t}{\hbar} \\
		v &= \frac{1}{\hbar}\frac{\delta E}{\delta k} = \frac{1}{\hbar}\frac{\delta E(k(t))}{\delta k} = v_g(k(t)) \\
		a &= \frac{F_{ext}}{m^*(k)} \\
		\frac{1}{m^*(k)} &= \frac{1}{\hbar^2}\frac{\delta^2E}{\delta k^2}
	\end{align}
	The conduction band is represented in the following figure, along with the group velocity and the effective mass.
	\begin{center}
		\begin{tikzpicture}
			\draw[dashed, gray]	(-2, 2) node[above]{$-\pi/a$} to (-2, -6);
			\draw[dashed, gray]	(2, 2) node[above]{$\pi/a$} to (2, -6);

			\draw[->, black]	(-2.2, 0) to (2.2, 0) node[right]{$k$};
			\draw[->, black]	(0, 0) to (0, 2.2) node[right]{$E$};
			\draw[blue, very thick]	plot[samples=200, domain=-2:2]	(\x, {sin(90*(\x + 1)) + 1});

			\draw[->, black]	(-2.2, -3) to (2.2, -3) node[right]{$t$};
			\draw[->, black]	(0, -3) to (0, -1) node[right]{$v_g$};
			\draw[blue, very thick]	plot[samples=200, domain=-2:2]	(\x, {sin(90*\x) -3});

			\draw[->, black]	(-2.2, -6) to (2.2, -6) node[right]{$t$};
			\draw[->, black]	(0, -6) to (0, -4) node[right]{$m^*$};
			\draw[blue, very thick]	plot[samples=200, domain=-1:1]	(\x, \x*\x*\x*\x - 5.5);
			\draw[blue, very thick]	plot[samples=200, domain=0:1]	(\x - 2, -\x*\x*\x*\x - 6.1);
			\draw[blue, very thick]	plot[samples=200, domain=-1:0]	(\x + 2, -\x*\x*\x*\x - 6.1);
		\end{tikzpicture}
	\end{center}
	If we would let the CB go beyond $\pi/a$, we would get an oscilation. This leads to an oscilation of the group velocity, too. This are called \textbf{Bloch oscilations}.\\
	How should one interpret these graphs? Well, suppose we start at no external force, then we are at $k=0$. Once a force is introduced, we see $k$ change. One important thing to extract from the figures, is that when going away from the CB minimum, the calculations make no sense anymore (just look at $m^*$). \\ \newline
	One thing to note, too, is that the time constant for the Bloch oscilations is much larger than other time constants of the crystal (defects, backscattering, \dots), i.e., $\tau_B >> \tau_{scatt}$ meaning one doesn't see these Bloch oscilations before a full oscilation of the $k$ value.
}

\subsection{Importance of holes}
Say we have a full VB, then the total crystal momentum is $$\vec{P}_{C, VB}^{tot} = \vec{0} = \sum_{\vec{k}, VB}\hbar\vec{k}$$
Now if we introduce one empty state at $\vec{k}_0$, i.e., a hole, we get the following momentum $$\vec{P}_{C, VB}^{tot} = \sum_{\vec{k}, VB}\hbar\vec{k} - \hbar\vec{k}_0 = \vec{0} - \hbar\vec{k}_0 = - \hbar\vec{k}_0$$
Then a hole can be defined to have a crystal momentum of $$\vec{P}_{C, VB} = - \hbar\vec{k}_0$$

\subsubsection{Movement of holes and electrons}
If we look at the semi-classical description for the external force acting on the electrons/holes, we see for an electron the following description
\begin{align}
	\hbar\frac{\delta \vec{k}_{electron}}{\delta t} &= \vec{F}_{ext} \label{eqn:mov_elec_vgl} \\
	&= -e(\vec{E} + \vec{v}\times\vec{B})
\end{align}
Then, if we define $\vec{k}_h = -\vec{k}_{electron}$ for a hole, we get
\begin{align}
	\hbar\frac{\delta (- \vec{k}_{electron})}{\delta t} &= -\vec{F}_{ext} \\
	\hbar\frac{\delta \vec{k}_{h}}{\delta t} &= -\vec{F}_{ext, h} \label{eqn:mov_hole_vgl} \\
	&= e(\vec{E} + \vec{v}\times\vec{B})
\end{align}
If we would now look at the equivalent Newton equation for electrons, we'd get (from equation \ref{eqn:mov_elec_vgl}) $$\vec{a} = \vec{m^*}^{-1}\cdot\vec{F}_{ext}$$
To define the one of holes we will introduce (as we did in previous sections) the hole effective mass: $\vec{m^*}^{-1}_h = -\vec{m^*}^{-1}$. In order that from equation \ref{eqn:mov_hole_vgl}, we'd get $$\vec{a} = -\vec{m^*}^{-1}_h\cdot\vec{F}_{ext}$$ $$\vec{a} = \vec{m^*}^{-1}_h\cdot\vec{F}_{ext, h}$$
Thus the acceleration for holes and electrons is the same (i.e., mass times force), just instead of heaving negative particles, we have positive particles for holes.
\nt{$\vec{v}\times\vec{B}$ is the Lorentz force acting on the crystal}
